// Data for Mario Kart music tracks
const data = [
    {
        "Track": "Mario Circut",
        "Game": "SNES",
        "Music": "https://www.youtube.com/embed/0cWb4DN44WU?enablejsapi=1"
    },
    {
        "Track": "Donut Plains",
        "Game": "SNES",
        "Music": "https://www.youtube.com/embed/RjKEHtMi5Ps?enablejsapi=1"
    },
    {
        "Track": "Ghost Valley",
        "Game": "SNES",
        "Music": "https://www.youtube.com/embed/EkGHNfb39hM?enablejsapi=1"
    },
    {
        "Track": "Bowser Castle",
        "Game": "SNES",
        "Music": "https://www.youtube.com/embed/7NMQUBOXu1g?enablejsapi=1"
    },
    {
        "Track": "Choco Island",
        "Game": "SNES",
        "Music": "https://www.youtube.com/embed/wSTfc2TNajk?enablejsapi=1"
    },
    {
        "Track": "Koopa Beach",
        "Game": "SNES",
        "Music": "https://www.youtube.com/embed/VWwGKT5jU-4?enablejsapi=1"
    },
    {
        "Track": "Vanilla Lake",
        "Game": "SNES",
        "Music": "https://www.youtube.com/embed/btG1GTXgYvo?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road",
        "Game": "SNES",
        "Music": "https://www.youtube.com/embed/K03ATBNi3Vw?enablejsapi=1"
    },
    {
        "Track": "Luigi/Mario/Royal Raceway/Wario Stadium",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/kAEbY1t7qnA?enablejsapi=1"
    },
    {
        "Track": "Moo Moo Farm/Yoshi Valley",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/KE5v8hAlfO0?enablejsapi=1"
    },
    {
        "Track": "Koopa Troopa Beach",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/WGFAPl2uu28?enablejsapi=1"
    },
    {
        "Track": "Kalimari Desert",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/KHKzR32XTx0?enablejsapi=1"
    },
    {
        "Track": "Toad's Turnpike",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/7gwdPCs9Q8w?enablejsapi=1"
    },
    {
        "Track": "Frappe Snowland/Sherbet Land",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/fW-hUbIQbo0?enablejsapi=1"
    },
    {
        "Track": "Choco Mountain",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/d89TbeknMjQ?enablejsapi=1"
    },
    {
        "Track": "Bowser's Castle",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/4CaB1p2ofeQ?enablejsapi=1"
    },
    {
        "Track": "DK's Jungle Parkway",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/PT0cc8Mj6L4?enablejsapi=1"
    },
    {
        "Track": "Banshee Boardwalk",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/xXc94g3Z2g8?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road",
        "Game": "N64",
        "Music": "https://www.youtube.com/embed/BukCo9ebcSc?enablejsapi=1"
    },
    {
        "Track": "Bowser Castle",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/ftljyBY54oE?enablejsapi=1"
    },
    {
        "Track": "Broken Pier/Boo Lake",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/agtbhkWq9JE?enablejsapi=1"
    },
    {
        "Track": "Cheep-Cheep Island/Shy Guy Beach",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/q8U2e9hIrBs?enablejsapi=1"
    },
    {
        "Track": "Cheese Land",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/cAxzBLBbMJU?enablejsapi=1"
    },
    {
        "Track": "Lakeside Park",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/vkvXBZoAZjo?enablejsapi=1"
    },
    {
        "Track": "Luigi/Mario/Peach Circuit",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/VibyrrLmtN0?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/YRJGBoa2uQc?enablejsapi=1"
    },
    {
        "Track": "Ribbon Road",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/wiOY4x8dTq8?enablejsapi=1"
    },
    {
        "Track": "Riverside Park",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/s2xjL3cSNRw?enablejsapi=1"
    },
    {
        "Track": "Sky Garden",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/6u7FIO4PD2s?enablejsapi=1"
    },
    {
        "Track": "Snow Land",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/ClmwqzCxnk8?enablejsapi=1"
    },
    {
        "Track": "Sunset Wilds",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/nvGWJ8-1yfQ?enablejsapi=1"
    },
    {
        "Track": "Yoshi Desert",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/NBmFzucLuG8?enablejsapi=1"
    },
    {
        "Track": "Mario Circut*SNES",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/mOtc4UIbu4A?enablejsapi=1"
    },
    {
        "Track": "Donut Plains*SNES",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/kOAJWEzs-Vk?enablejsapi=1"
    },
    {
        "Track": "Ghost Valley*SNES",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/-GwpqycEKTQ?enablejsapi=1"
    },
    {
        "Track": "Bowser Castle*SNES",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/tRaiFM7WXQY?enablejsapi=1"
    },
    {
        "Track": "Choco Island*SNES",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/VLL0rqE8XxY?enablejsapi=1"
    },
    {
        "Track": "Koopa Beach*SNES",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/-sSIEBZsREI?enablejsapi=1"
    },
    {
        "Track": "Vanilla Lake*SNES",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/0EShv7x5KSU?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road*SNES",
        "Game": "GBA",
        "Music": "https://www.youtube.com/embed/0-aph89zTQI?enablejsapi=1"
    },
    {
        "Track": "Baby Park",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/fmnlHkcLcl0?enablejsapi=1"
    },
    {
        "Track": "Bowser's Castle",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/DRF6S2XWq8s?enablejsapi=1"
    },
    {
        "Track": "Daisy Cruiser/Peach Beach",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/ciy_FfT5BxU?enablejsapi=1"
    },
    {
        "Track": "Dino Dino Jungle/DK Mountain",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/Bb8upG1cBzM?enablejsapi=1"
    },
    {
        "Track": "Dry Dry Desert",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/WRh8xUeBoHo?enablejsapi=1"
    },
    {
        "Track": "Luigi/Mario/Yoshi Circuit",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/s0veQ0op_TY?enablejsapi=1"
    },
    {
        "Track": "Mushroom Bridge/City",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/l4Zu4ev589A?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/54-1Y-KIhjY?enablejsapi=1"
    },
    {
        "Track": "Sherbet Land",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/3kmS1w_QaZo?enablejsapi=1"
    },
    {
        "Track": "Waluigi Stadium/Wario Colosseum",
        "Game": "GCN",
        "Music": "https://www.youtube.com/embed/anNkuBr0LOQ?enablejsapi=1"
    },
    {
        "Track": "Airship Fortress",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/F64ca_OtSC4?enablejsapi=1"
    },
    {
        "Track": "Bowser's Castle",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/uLPCyHoxJ74?enablejsapi=1"
    },
    {
        "Track": "Cheep Cheep Beach",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/dvK-9ZPniiE?enablejsapi=1"
    },
    {
        "Track": "Delfino Square",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/FBLkqTNDRFc?enablejsapi=1"
    },
    {
        "Track": "Desert Hills",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/ojSGQtPkkGo?enablejsapi=1"
    },
    {
        "Track": "DK Pass",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/oSWsGJsexH8?enablejsapi=1"
    },
    {
        "Track": "Figure-8/Mario Circuit",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/FcvTQ3rCv7Q?enablejsapi=1"
    },
    {
        "Track": "Luigi's Mansion",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/oNjdDJJiT4w?enablejsapi=1"
    },
    {
        "Track": "Peach Gardens",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/z6sySQ7bSeQ?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/aYMUBncWSho?enablejsapi=1"
    },
    {
        "Track": "Shroom Ridge",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/-Gf0-nl2yl8?enablejsapi=1"
    },
    {
        "Track": "Tick Tock Clock",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/YoFEjCzIIr4?enablejsapi=1"
    },
    {
        "Track": "Waluigi Pinball/Wario Stadium",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/r8il_hiOIsQ?enablejsapi=1"
    },
    {
        "Track": "Yoshi Falls",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/Y--XP94X-gA?enablejsapi=1"
    },
    {
        "Track": "Yoshi/Luigi Circuit*GCN",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/xbO915snLUE?enablejsapi=1"
    },
    {
        "Track": "Mushroom Bridge*GCN",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/5aZPRWfZbZg?enablejsapi=1"
    },
    {
        "Track": "Baby Park*GCN",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/Uq3OMKpPjSc?enablejsapi=1"
    },
    {
        "Track": "Sky Garden*GBA",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/zs4rweimPIQ?enablejsapi=1"
    },
    {
        "Track": "Peach/Luigi Circuit*GBA",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/A9W3j9h1Vqg?enablejsapi=1"
    },
    {
        "Track": "Bowser Castle*GBA",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/VCg3VpdpCnw?enablejsapi=1"
    },
    {
        "Track": "Moo Moo Farm*N64",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/r-4EG_bljnk?enablejsapi=1"
    },
    {
        "Track": "Frappe Snowland*N64",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/pPXoE72n9do?enablejsapi=1"
    },
    {
        "Track": "Choco Mountain*N64",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/Y_kNYKk2oWE?enablejsapi=1"
    },
    {
        "Track": "Banshee Boardwalk*N64",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/YO6Q_Nb58LQ?enablejsapi=1"
    },
    {
        "Track": "Koopa Beach*SNES",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/EHnjBObTUvs?enablejsapi=1"
    },
    {
        "Track": "Mario Circuit*SNES",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/BJtas-JGzwk?enablejsapi=1"
    },
    {
        "Track": "Choco Island*SNES",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/Kd6wYvVq2oU?enablejsapi=1"
    },
    {
        "Track": "Donut Plains*SNES",
        "Game": "DS",
        "Music": "https://www.youtube.com/embed/sGiQkeuRNI0?enablejsapi=1"
    },
    {
        "Track": "Bowser's Castle",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/sse_rCWUZKA?enablejsapi=1"
    },
    {
        "Track": "Coconut Mall",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/GnTtoXofLE4?enablejsapi=1"
    },
    {
        "Track": "Daisy Circuit",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/3HB7k-LnEK4?enablejsapi=1"
    },
    {
        "Track": "DK Summit",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/FPgEWKs7_8k?enablejsapi=1"
    },
    {
        "Track": "Dry Dry Ruins",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/PM2GTRprhk0?enablejsapi=1"
    },
    {
        "Track": "Grumble Volcano",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/VmUaKZTxUOI?enablejsapi=1"
    },
    {
        "Track": "Koopa Cape",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/7V24jvj6Cpc?enablejsapi=1"
    },
    {
        "Track": "Luigi/Mario Circuit",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/Y0wDjtZxfgI?enablejsapi=1"
    },
    {
        "Track": "Maple Treeway",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/ST6iHHyhxN0?enablejsapi=1"
    },
    {
        "Track": "Moo Moo Meadows",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/evI68-pCD9k?enablejsapi=1"
    },
    {
        "Track": "Moonview Highway",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/o7IR4fvk5Go?enablejsapi=1"
    },
    {
        "Track": "Mushroom Gorge",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/Z8QPmcY8_v8?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/n08v3W5VjOY?enablejsapi=1"
    },
    {
        "Track": "Toad's Factory",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/5vOyZFGo4c0?enablejsapi=1"
    },
    {
        "Track": "Wario's Gold Mine",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/Me2E4oZIZ8o?enablejsapi=1"
    },
    {
        "Track": "Ghost Valley*SNES",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/W2QhEljTBf8?enablejsapi=1"
    },
    {
        "Track": "Mario Circuit*SNES",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/VVbwvXq1yHw?enablejsapi=1"
    },
    {
        "Track": "Bowser's Castle*N64",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/bB9MGilBYPY?enablejsapi=1"
    },
    {
        "Track": "D.K.'s Jungle Parkway*N64",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/kncX8J1jG5Y?enablejsapi=1"
    },
    {
        "Track": "Mario Raceway*N64",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/IP18XC-CFOo?enablejsapi=1"
    },
    {
        "Track": "Sherbet Land*N64",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/LJZzY8WZrFs?enablejsapi=1"
    },
    {
        "Track": "Bowser Castle*GBA",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/67wruNkg9EI?enablejsapi=1"
    },
    {
        "Track": "Shy Guy Beach*GBA",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/VD1Aw28dICA?enablejsapi=1"
    },
    {
        "Track": "DK Mountain*GCN",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/WY9XZJaYTwI?enablejsapi=1"
    },
    {
        "Track": "Mario Circuit*GCN",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/w9Z4tDZ5NZY?enablejsapi=1"
    },
    {
        "Track": "Peach Beach*GCN",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/YCKjCkLGHfs?enablejsapi=1"
    },
    {
        "Track": "Waluigi Stadium*GCN",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/P4bTvG7H3jI?enablejsapi=1"
    },
    {
        "Track": "Delfino Square*DS",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/QLyiBTkFe1g?enablejsapi=1"
    },
    {
        "Track": "Desert Hills*DS",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/SVtejJbPCWE?enablejsapi=1"
    },
    {
        "Track": "Peach Gardens*DS",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/jlOm_p412bY?enablejsapi=1"
    },
    {
        "Track": "Yoshi Falls*DS",
        "Game": "Wii",
        "Music": "https://www.youtube.com/embed/DB9DU2Gpen0?enablejsapi=1"
    },
    {
        "Track": "Bowser's Castle",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/XLPHDmto4NU?enablejsapi=1"
    },
    {
        "Track": "Cheep Cheep Lagoon",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/kkKTS8u2Mmc?enablejsapi=1"
    },
    {
        "Track": "Daisy Hills",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/XYhxe7um8UU?enablejsapi=1"
    },
    {
        "Track": "DK Jungle",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/JQa3Ec002BI?enablejsapi=1"
    },
    {
        "Track": "Maka Wuhu/Wuhu Loop",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/zDkujza1dBg?enablejsapi=1"
    },
    {
        "Track": "Mario/Toad Circuit",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/l_ge2sh_i4M?enablejsapi=1"
    },
    {
        "Track": "Music Park",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/H4cUSKyfLTU?enablejsapi=1"
    },
    {
        "Track": "Neo Bowser City",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/fxsPY5GYaFE?enablejsapi=1"
    },
    {
        "Track": "Piranha Plant Slide",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/suunRbUjMZE?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/rDvTEBRNAg8?enablejsapi=1"
    },
    {
        "Track": "Rock Rock Mountain",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/CVACOZLloAo?enablejsapi=1"
    },
    {
        "Track": "Rosalina's Ice World",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/yKgpEXEni94?enablejsapi=1"
    },
    {
        "Track": "Shy Guy Bazaar",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/n6uevXn6Mbs?enablejsapi=1"
    },
    {
        "Track": "Wario Shipyard",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/n6ulEdXILmE?enablejsapi=1"
    },
    {
        "Track": "Mario Circuit*SNES",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/01MiYt22sfU?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road*SNES",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/wW1MU1770MM?enablejsapi=1"
    },
    {
        "Track": "Kalimari Desert*N64",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/dOehe5VGOM0?enablejsapi=1"
    },
    {
        "Track": "Koopa Troopa Beach*N64",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/3Ck53TnRXMs?enablejsapi=1"
    },
    {
        "Track": "Luigi Raceway*N64",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/H3IbqYmx_gg?enablejsapi=1"
    },
    {
        "Track": "Bowser Castle*GBA",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/tRG_hKDM7rM?enablejsapi=1"
    },
    {
        "Track": "Daisy Cruiser*GCN",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/ZszbRyNiX0E?enablejsapi=1"
    },
    {
        "Track": "Dino Dino Jungle*GCN",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/Qb8PzbnCioU?enablejsapi=1"
    },
    {
        "Track": "Airship Fortress*DS",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/_dIWhQN0cDc?enablejsapi=1"
    },
    {
        "Track": "DK Pass*DS",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/Ij3XMe1P94A?enablejsapi=1"
    },
    {
        "Track": "Luigi's Mansion*DS",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/I6O3tIbwoQU?enablejsapi=1"
    },
    {
        "Track": "Waluigi Pinball*DS",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/ow6N7gAq6KI?enablejsapi=1"
    },
    {
        "Track": "Coconut Mall*Wii",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/1u-dIzPYLaM?enablejsapi=1"
    },
    {
        "Track": "Koopa Cape*Wii",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/i2Lyx86q9kg?enablejsapi=1"
    },
    {
        "Track": "Maple Treeway*Wii",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/6V-BBMQnmUA?enablejsapi=1"
    },
    {
        "Track": "Mushroom Gorge*Wii",
        "Game": "3DS",
        "Music": "https://www.youtube.com/embed/Ix5G6xLCavc?enablejsapi=1"
    },
    {
        "Track": "Amsterdam Drift",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/moawdOCyZaQ?enablejsapi=1"
    },
    {
        "Track": "Animal Crossing (Spring)",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/vDMPKHRze30?enablejsapi=1"
    },
    {
        "Track": "Animal Crossing (Summer)",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/ai7KOqVIBXQ?enablejsapi=1"
    },
    {
        "Track": "Animal Crossing (Autumn)",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/rflCLskdZwE?enablejsapi=1"
    },
    {
        "Track": "Animal Crossing (Winter)",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/Z6-MAxAFdRQ?enablejsapi=1"
    },
    {
        "Track": "Athens Dash",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/g7l-EydZdu4?enablejsapi=1"
    },
    {
        "Track": "Bangkok Rush",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/51wX3b_Q8G8?enablejsapi=1"
    },
    {
        "Track": "Berlin Byways",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/oa_pKxJRRjs?enablejsapi=1"
    },
    {
        "Track": "Big Blue",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/-gCSKx4Xb_A?enablejsapi=1"
    },
    {
        "Track": "Bone Dry Dunes",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/yNPen35RFwI?enablejsapi=1"
    },
    {
        "Track": "Bowser's Castle",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/C2NaUU_wUyU?enablejsapi=1"
    },
    {
        "Track": "Cloudtop Cruise",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/4MKuBwQSU3o?enablejsapi=1"
    },
    {
        "Track": "Dolphin Shoals",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/pUmzNty43Fo?enablejsapi=1"
    },
    {
        "Track": "Dragon Driftway",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/KxrC9SacTgE?enablejsapi=1"
    },
    {
        "Track": "Electrodrome",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/wHKD9jhqZfM?enablejsapi=1"
    },
    {
        "Track": "Excitebike Arena",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/LqyFsdi3BN8?enablejsapi=1"
    },
    {
        "Track": "Hyrule Circuit",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/Uc9k8Xi137g?enablejsapi=1"
    },
    {
        "Track": "Ice Ice Outpost",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/vudk2nlJlto?enablejsapi=1"
    },
    {
        "Track": "London Loop",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/rAxJlLB8WJo?enablejsapi=1"
    },
    {
        "Track": "Los Angeles Laps",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/LfVGF6p2mzM?enablejsapi=1"
    },
    {
        "Track": "Madrid Drive",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/JvBZ4yqZlsw?enablejsapi=1"
    },
    {
        "Track": "Mario Circuit",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/M-xzowm5Vf0?enablejsapi=1"
    },
    {
        "Track": "Mario Kart Stadium",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/PT0xjQpYw7I?enablejsapi=1"
    },
    {
        "Track": "Merry Mountain",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/0LRLEQ3kMk4?enablejsapi=1"
    },
    {
        "Track": "Mount Wario",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/R1fZFQrxgdc?enablejsapi=1"
    },
    {
        "Track": "Mute City",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/9zyPO2hF8_o?enablejsapi=1"
    },
    {
        "Track": "New York Minute",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/WPdM3ZQQNKI?enablejsapi=1"
    },
    {
        "Track": "Ninja Hideaway",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/pT7KfbmjZfc?enablejsapi=1"
    },
    {
        "Track": "Paris Promenade",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/m3KwmFw1SIA?enablejsapi=1"
    },
    {
        "Track": "Piranha Plant Cove",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/AUF939hZcJA?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/ksDFjM_5r_s?enablejsapi=1"
    },
    {
        "Track": "Rome Avanti",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/0tCu6H-DWpE?enablejsapi=1"
    },
    {
        "Track": "Shy Guy Falls",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/kWlIlLg5o6c?enablejsapi=1"
    },
    {
        "Track": "Singapore Speedway",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/-JfhBus8qvU?enablejsapi=1"
    },
    {
        "Track": "Sky-High Sundae",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/E4pZSsb5wjU?enablejsapi=1"
    },
    {
        "Track": "Squeaky Clean Sprint",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/M0gAWagqLv8?enablejsapi=1"
    },
    {
        "Track": "Sunshine Airport",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/bSX2aoAn_u0?enablejsapi=1"
    },
    {
        "Track": "Super Bell Subway",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/t6CJuJFqMr8?enablejsapi=1"
    },
    {
        "Track": "Sweet Sweet Canyon",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/de1VzbiLRnU?enablejsapi=1"
    },
    {
        "Track": "Sydney Sprint",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/1xJ3hVhsQEI?enablejsapi=1"
    },
    {
        "Track": "Thwomp Ruins",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/P45IbrhL-io?enablejsapi=1"
    },
    {
        "Track": "Toad Harbor",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/F1-pwhFgDdo?enablejsapi=1"
    },
    {
        "Track": "Tokyo Blur",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/EZyL1ZNhOw8?enablejsapi=1"
    },
    {
        "Track": "Twisted Mansion",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/D1OzmnP5Sqs?enablejsapi=1"
    },
    {
        "Track": "Vancouver Velocity",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/jFTUxfCwCFE?enablejsapi=1"
    },
    {
        "Track": "Water Park",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/O9jsbQ5SNHA?enablejsapi=1"
    },
    {
        "Track": "Wild Woods",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/VKGPcEn12po?enablejsapi=1"
    },
    {
        "Track": "Yoshi's Island",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/ev9ubsGxbR0?enablejsapi=1"
    },
    {
        "Track": "Bowser Castle*SNES",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/KDJg4KijWik?enablejsapi=1"
    },
    {
        "Track": "Donut Plains*SNES",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/buWT9z2rang?enablejsapi=1"
    },
    {
        "Track": "Mario Circuit*SNES",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/6qGmxdWz2dI?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road*SNES",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/jtCGHlt4MQc?enablejsapi=1"
    },
    {
        "Track": "Choco Mountain*N64",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/UC9Zw7mOG10?enablejsapi=1"
    },
    {
        "Track": "Kalimari Desert*N64",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/7qsKAXV0F_M?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road*N64",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/x-6KhR9y86c?enablejsapi=1"
    },
    {
        "Track": "Royal Raceway*N64",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/RrIYFTWTabc?enablejsapi=1"
    },
    {
        "Track": "Toad's Turnpike*N64",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/o3EFS-0vieY?enablejsapi=1"
    },
    {
        "Track": "Yoshi Valley*N64",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/8Q2GPsHuc04?enablejsapi=1"
    },
    {
        "Track": "Boo Lake*GBA",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/FfMlIAd8P_Y?enablejsapi=1"
    },
    {
        "Track": "Cheese Land*GBA",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/Hvfc9jukUzU?enablejsapi=1"
    },
    {
        "Track": "Mario Circuit*DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/-HaMsPMRlA8?enablejsapi=1"
    },
    {
        "Track": "Ribbon Road*GBA",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/TK8BBKW2zWU?enablejsapi=1"
    },
    {
        "Track": "Riverside Park*GBA",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/daeP8bFTcG0?enablejsapi=1"
    },
    {
        "Track": "Sky Garden*GBA",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/UnhQkqoRZF0?enablejsapi=1"
    },
    {
        "Track": "Snow Land*GBA",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/56-3qWLfuoA?enablejsapi=1"
    },
    {
        "Track": "Sunset Wilds*GBA",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/FN4MVMHCLsE?enablejsapi=1"
    },
    {
        "Track": "Baby Park*GCN",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/ZSKaBIkAftY?enablejsapi=1"
    },
    {
        "Track": "Daisy Cruiser*GCN",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/OaT5Sar0Fjc?enablejsapi=1"
    },
    {
        "Track": "DK Mountain*GCN",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/B2wNY9cxwYA?enablejsapi=1"
    },
    {
        "Track": "Dry Dry Desert*GCN",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/AggNZ_4M1K8?enablejsapi=1"
    },
    {
        "Track": "Sherbet Land*GCN",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/NEDmdHJhYMk?enablejsapi=1"
    },
    {
        "Track": "Waluigi Stadium*GCN",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/KNAtGMp4Udk?enablejsapi=1"
    },
    {
        "Track": "Yoshi Circuit*GCN",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/z_VLTex9o9w?enablejsapi=1"
    },
    {
        "Track": "Cheep Cheep Beach*DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/nVf0fT4hGpw?enablejsapi=1"
    },
    {
        "Track": "Mario Circuit*GBA",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/73-7ENHTYGY?enablejsapi=1"
    },
    {
        "Track": "Peach Gardens*DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/JLzRnjzW-GA?enablejsapi=1"
    },
    {
        "Track": "Shroom Ridge*DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/f_0cxI9I7Ns?enablejsapi=1"
    },
    {
        "Track": "Tick Tock Clock*DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/pW2Pvrwy3JM?enablejsapi=1"
    },
    {
        "Track": "Waluigi Pinball/Wario Stadium*DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/XvcUMvGY6IY?enablejsapi=1"
    },
    {
        "Track": "Coconut Mall*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/Af4bC-78gsU?enablejsapi=1"
    },
    {
        "Track": "Daisy Circuit*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/BxeyI7D9u4s?enablejsapi=1"
    },
    {
        "Track": "DK Summit*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/HL9RN8VFojY?enablejsapi=1"
    },
    {
        "Track": "Grumble Volcano*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/5TvsoGqZuJ0?enablejsapi=1"
    },
    {
        "Track": "Koopa Cape*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/XMiHXln0Afk?enablejsapi=1"
    },
    {
        "Track": "Maple Treeway*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/aJAPDCEXsGA?enablejsapi=1"
    },
    {
        "Track": "Moo Moo Meadows*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/Pa21uDOkwyM?enablejsapi=1"
    },
    {
        "Track": "Moonview Highway*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/wqU6MA_VMXI?enablejsapi=1"
    },
    {
        "Track": "Mushroom Gorge*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/OL_5IKFde3o?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/VO8rz5jPQK4?enablejsapi=1"
    },
    {
        "Track": "Wario's Gold Mine*Wii",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/deh16-OC7S4?enablejsapi=1"
    },
    {
        "Track": "DK Jungle*3DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/kiD_uZIozpA?enablejsapi=1"
    },
    {
        "Track": "Music Park*3DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/4n0YAd4p_IE?enablejsapi=1"
    },
    {
        "Track": "Neo Bowser City*3DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/oYJTvBcsuI4?enablejsapi=1"
    },
    {
        "Track": "Piranha Plant Slide*3DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/M4wHtOtapLA?enablejsapi=1"
    },
    {
        "Track": "Rainbow Road*3DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/FtP351pCbM4?enablejsapi=1"
    },
    {
        "Track": "Rock Rock Mountain*3DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/znuftt4Lwuw?enablejsapi=1"
    },
    {
        "Track": "Rosalina's Ice World*3DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/8qHSgaUzXHA?enablejsapi=1"
    },
    {
        "Track": "Toad Circuit*3DS",
        "Game": "Switch",
        "Music": "https://www.youtube.com/embed/iwpIxjweeuY?enablejsapi=1"
    }
];

/* Get today's date in UTC format (YYYY-MM-DD) and check if the player has played today. 
    If so, retrieve their result for displaying later */
const currentUTC = new Date();
const currentDate = currentUTC.toISOString().split('T')[0];
let todaysResult = localStorage.getItem(`${currentDate}_result`);
let playedToday = false;
if (todaysResult) {
    playedToday = true;
}

// DOM Elements for global use
const trackInput = document.querySelector('input.track');
const gameInput = document.querySelector('input.game');
const playButton = document.getElementById("playButton");
const pauseButton = document.getElementById("pauseButton");
const restartButton = document.getElementById("restartButton");
const settingsButton = document.getElementById("settings");
const settingsSaveButton = document.getElementById("save");
const youtube = document.getElementById("youtube");
const guessButton = document.getElementById("submitGuess");
const allGuesses = document.querySelectorAll('#guess');
const resultsOverlay = document.getElementById("gameOver")

// Game state variables
let guessNum = 1; // Current guess number (1-6)
let playing = false; // Is the track currently playing
let finalResult = ''; // Final result string for sharing
let hintsUsed = 0; // Number of hints used this game

// Load player stats from localStorage
let playerDifficulty = localStorage.getItem('difficulty');
let totalCorrect = localStorage.getItem('totalCorrect');
let totalGames = localStorage.getItem('totalGames');
let lastPlayedDate = localStorage.getItem('lastPlayedDate');
let streakCount = localStorage.getItem('streakCount');
let num6Guesses = localStorage.getItem('num6Guesses');
let num5Guesses = localStorage.getItem('num5Guesses');
let num4Guesses = localStorage.getItem('num4Guesses');
let num3Guesses = localStorage.getItem('num3Guesses');
let num2Guesses = localStorage.getItem('num2Guesses');
let num1Guesses = localStorage.getItem('num1Guesses');
let numXGuesses = localStorage.getItem('numXGuesses');
// Initialize stats if they don't exist
if (!totalCorrect) totalCorrect = 0;
if (!totalGames) totalGames = 0;
if (!streakCount) streakCount = 0;
if (!lastPlayedDate) lastPlayedDate = '';
if (!playerDifficulty) playerDifficulty = 'normal';
if (!numXGuesses) numXGuesses = 0;
if (!num6Guesses) num6Guesses = 0;
if (!num5Guesses) num5Guesses = 0;
if (!num4Guesses) num4Guesses = 0;
if (!num3Guesses) num3Guesses = 0;
if (!num2Guesses) num2Guesses = 0;
if (!num1Guesses) num1Guesses = 0;


// YouTube Player API setup
var player;
let playerReady = false;
let needsRestart = false;
let playTimeAllowed = 1000; // milliseconds

const trackOfTheDay = pickRandomTrack(); // Pre-select the track of the day

const src = trackOfTheDay.Music; // YouTube video URL

function onPlayerReady(event) {
    player = event.target;
    playerReady = true;
}

function onPlayerStateChange(event) {
  if (event.data === YT.PlayerState.PLAYING && needsRestart) {
    needsRestart = false;
    player.seekTo(0, true);
  }
}


window.onYouTubeIframeAPIReady = function() {
  player = new YT.Player('youtube', {
    videoId: src,
    playerVars: {
      'playsinline': 1
    },
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });
}

// Initialize the game when the DOM is fully loaded
document.addEventListener('DOMContentLoaded', function() {
    const trackOfTheDay = pickRandomTrack(); // Pre-select the track of the day
    const src = trackOfTheDay.Music; // YouTube video URL
    
    // Set difficulty display and hint button visibility
    if (playerDifficulty === 'hard') {
        document.getElementById('hintButton').style.display = 'none';
        document.getElementById('currentDifficulty').textContent = `${playerDifficulty}`;
    }
    document.getElementById('currentDifficulty').textContent = `${playerDifficulty}`;

    // Populate track options on game selection (per-guess)
    document.querySelectorAll('input.game').forEach(function(gameInputElement) {
        gameInputElement.addEventListener('click', function() {
            gameInputElement.value = ""; // Clear the input on click
        });

        gameInputElement.addEventListener('change', () => updateTrackList(gameInputElement));
    });

    document.querySelectorAll('input.track').forEach(function(trackInputElement) {
        trackInputElement.addEventListener('click', function() {
            trackInputElement.value = ""; // Clear the input on click
        });
    });

    // Set up playback control buttons
    playButton.addEventListener('click', playButtonClicked);
    pauseButton.addEventListener('click', pauseButtonClicked);
    restartButton.addEventListener('click', restartButtonClicked);

    // If the player has already played today, disable inputs and show results
    if (playedToday) {
        guessButton.disabled = true;
        document.getElementById('hintButton').disabled = true;
        showResults(trackOfTheDay, todaysResult);
    }

    // Set up guess submission button
    guessButton.addEventListener('click', () => guessButtonClicked(trackOfTheDay));

    // Set up close buttons for overlays
    document.getElementById('closeResults').addEventListener('click', function () {
        resultsOverlay.classList.add('hidden');
    });
    document.getElementById('closeStats').addEventListener('click', function () {
        document.getElementById('statsOverlay').classList.add('hidden');
    });
    document.getElementById('closeSettings').addEventListener('click', function () {
        document.getElementById('settingsOverlay').classList.add('hidden');
    });

    // Set up share, results, settings, and stats buttons
    document.getElementById('share').addEventListener('click', function () {
        // Copy finalResult to clipboard
        navigator.clipboard.writeText(resultString);
        document.getElementById('share').textContent = 'Copied to Clipboard';
    });

    document.getElementById('stats').addEventListener('click', function () {
        document.getElementById('statsOverlay').classList.remove('hidden');
        document.getElementById('gamesPlayed').textContent = `Total Games: ${totalGames}`;
        let accuracy = 0;
        if (totalGames > 0) {
            accuracy = Math.round((totalCorrect / totalGames) * 100);                           
        }
        document.getElementById('correctPercent').textContent = `Percent Guessed: ${accuracy}%`;
        document.getElementById('currentStreak').textContent = `Current Streak: ${streakCount}`;
        createGuessChart();
    });

    document.getElementById('resultsButton').addEventListener('click', function () {
        resultsOverlay.classList.remove('hidden');
    });

    settingsButton.addEventListener('click', function () {
        document.getElementById('settingsOverlay').classList.remove('hidden');
    });

    // Set up save and hint buttons
    settingsSaveButton.addEventListener('click', saveSettings);

    document.getElementById('hintButton').addEventListener('click', hintButtonPressed);
});


function pickRandomTrack() {
    // Deterministically shuffle the track list and pick one based on the current UTC day
    const SHUFFLE_SEED = 0xC0FFEE; // any fixed number

    const startDate = Date.UTC(2024, 0, 1); // fixed epoch
    const todayUTC = Date.now();
    const dayIndex = Math.floor((todayUTC - startDate) / 86400000);

    const shuffledData = shuffleDeterministic(data, SHUFFLE_SEED);
    const index = dayIndex % shuffledData.length;
    const track = shuffledData[index];

    return track;
}

function mulberry32(seed) {
    // Returns a seeded pseudo-random number generator function
    return function () {
        let t = seed += 0x6D2B79F5;
        t = Math.imul(t ^ t >>> 15, t | 1);
        t ^= t + Math.imul(t ^ t >>> 7, t | 61);
        return ((t ^ t >>> 14) >>> 0) / 4294967296;
    };
}

function shuffleDeterministic(array, seed) {
    // Shuffle an array deterministically based on a seed
    const rng = mulberry32(seed);
    const arr = [...array];

    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(rng() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }

    return arr;
}

function parseResult(result) {
    /* turns ‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è into 
    1Ô∏è‚É£‚¨õÔ∏è‚¨õÔ∏è 4Ô∏è‚É£‚¨õÔ∏è‚¨õÔ∏è
    2Ô∏è‚É£‚¨õÔ∏è‚¨õÔ∏è 5Ô∏è‚É£‚¨õÔ∏è‚¨õÔ∏è
    3Ô∏è‚É£‚¨õÔ∏è‚¨õÔ∏è 6Ô∏è‚É£‚¨õÔ∏è‚¨õÔ∏è
    */
    // Split into grapheme clusters so emoji/variation selectors aren't split incorrectly
    let segments = [];
    if (typeof Intl !== 'undefined' && typeof Intl.Segmenter === 'function') {
        segments = [...new Intl.Segmenter(undefined, { granularity: 'grapheme' }).segment(result)].map(s => s.segment);
    } else {
        try {
            segments = result.match(/(\P{M}\p{M}*|\p{Extended_Pictographic}\uFE0F?|\p{Extended_Pictographic})/gu) || [];
        } catch (e) {
            segments = Array.from(result);
        }
    }

    // Each guess contributes 2 segments (game + track)
    const guessCount = Math.floor(segments.length / 2);
    if (guessCount === 0) return '';

    const numEmoji = ['0Ô∏è‚É£','1Ô∏è‚É£','2Ô∏è‚É£','3Ô∏è‚É£','4Ô∏è‚É£','5Ô∏è‚É£','6Ô∏è‚É£'];
    let final = '';

    // If 3 or fewer guesses, show that many rows (left column only).
    if (guessCount <= 3) {
        const lines = [];
        for (let i = 0; i < guessCount; i++) {
            const tiles = segments.slice(i * 2, i * 2 + 2).join('');
            lines.push(`${numEmoji[i + 1]}${tiles}`);
        }
        final = lines.join('\n');
    } else {

        // More than 3 guesses: use 3 rows, left col = guesses 1..3, right col = guesses 4..up to guessCount
        const rows = 3;
        const lines = [];
        for (let i = 0; i < rows; i++) {
            const leftTiles = segments.slice(i * 2, i * 2 + 2).join('');
            const rightGuessIndex = i + rows; // zero-based guess index for right column
            if (rightGuessIndex < guessCount) {
                const rightTiles = segments.slice(rightGuessIndex * 2, rightGuessIndex * 2 + 2).join('');
                lines.push(`${numEmoji[i + 1]}${leftTiles} ${numEmoji[rightGuessIndex + 1]}${rightTiles}`);
            } else {
                lines.push(`${numEmoji[i + 1]}${leftTiles}`);
            }
        }

        final = lines.join('\n');
    }
    // Prepend a readable date string so shared results show the date (e.g. "Dec 29, 2025")
    // Use UTC to match pickRandomTrack's UTC day calculation
    const date = new Date();
    const dateString = date.toLocaleDateString(undefined, { year: '2-digit', month: 'numeric', day: 'numeric', timeZone: 'UTC' });
    final = `MK Heardle ${dateString}\n` + final;
    // Append difficulty/hints info
    if (playerDifficulty === 'hard') {
        final += `\n*Hard Mode`;
    } else {
        final += `\nHints Used: ${hintsUsed}`;
    }

    return final;
}

function updateTrackList(gameInputElement) {
    // function to update track list based on selected game
    const currentGuessArea = gameInputElement.closest('.guessingArea');
        if (!currentGuessArea) return;
        // Find the track input inside this guess area
        const trackInputLocal = currentGuessArea.querySelector('input.track');
        trackInputLocal.value = "";
        if (!trackInputLocal) return;
        const datalistId = trackInputLocal.getAttribute('list');
        if (!datalistId) return;
        const trackOptionsElement = document.getElementById(datalistId);
        if (!trackOptionsElement) return;
        trackOptionsElement.innerHTML = '';
        for (let i = 0; i < data.length; i++) {
            if (data[i].Game === gameInputElement.value) {
                trackOptionsElement.appendChild(new Option(data[i].Track, data[i].Track));
            }
        }
}

function playButtonClicked() {
    // function to handle play button click
    if (playerDifficulty === 'normal') {
        document.getElementById('difficulty').disabled = true; // lock difficulty selection to prevent cheating
    }
    
    if (!playerReady) {
        return;
    } else {
        if (playerDifficulty === 'hard') {
            player.playVideo();
            setTimeout(function() {player.stopVideo();}, playTimeAllowed); // stop after allowed time for hard mode
        } else {
            player.playVideo();
        }
    }
}

function pauseButtonClicked() {
    // function to handle pause button click
    if (playerDifficulty === 'hard') {
        player.stopVideo();
    } else {
        player.pauseVideo();
    }
}

function restartButtonClicked() {
    // function to handle restart button click
    if (playerDifficulty === 'hard' && YT.PlayerState.PLAYING) {
        player.seekTo(0, true);
        setTimeout(function() {player.stopVideo();}, playTimeAllowed);
    } else {
        player.seekTo(0, true);
    }
}

function guessButtonClicked(trackOfTheDay) {
    // function to handle guess submission
    settingsSaveButton.disabled = true; // prevent changing settings mid-game

    let currentGuess = document.getElementById(`guess${guessNum}`);
    let nextGuess = document.getElementById(`guess${guessNum + 1}`);
    let currentGameInput = currentGuess.querySelector('.game');
    let currentTrackInput = currentGuess.querySelector('.track');

    playTimeAllowed += playTimeAllowed; // double allowed time each guess
    // normalize inputs for robust comparison
    const gameVal = currentGameInput.value.trim().toLowerCase();
    const trackVal = currentTrackInput.value.trim().toLowerCase();
    const answerGame = String(trackOfTheDay.Game).trim().toLowerCase();
    const answerTrack = String(trackOfTheDay.Track).trim().toLowerCase();

    // Check game guess
    if (gameVal && gameVal === answerGame) {
        currentGameInput.classList.add('correct');
        finalResult += 'üü©';
    } else {
        currentGameInput.classList.add('incorrect');
        finalResult += '‚¨õÔ∏è';
    }

    // Check track guess
    // exact match -> correct
    if (trackVal && trackVal === answerTrack) {
        currentTrackInput.classList.add('correct');
        finalResult += 'üü©';
    // partial input (non-empty) that's contained in answer -> almost
    } else if (trackVal.length > 0 && answerTrack.includes(trackVal)) {
        currentTrackInput.classList.add('almost');
        finalResult += 'üü®';
    // otherwise incorrect
    } else {
        currentTrackInput.classList.add('incorrect');
        finalResult += '‚¨õÔ∏è';
    }

    // Disable current inputs in preparation for next guess
    currentGameInput.disabled = true;
    currentTrackInput.disabled = true;

    // Execute game logic based on guess correctness
    if (currentGameInput.value === trackOfTheDay.Game && currentTrackInput.value === trackOfTheDay.Track) {
        guessCorrectly(trackOfTheDay, finalResult);
    } else if (guessNum === 6) { // all out of guesses
        guessIncorrectly(trackOfTheDay, finalResult);
    } else { // prepare for next guess
        nextGuess.classList.remove('hidden');
        if (playerDifficulty === 'hard') {
            document.getElementById('playbackTime').textContent = `Playback Time: ${playTimeAllowed/1000} second(s)`; // update playback time display
        }
        if (guessNum <= 6) {
            guessNum++;
        }
    }
}

function guessCorrectly(trackOfTheDay, finalResult) {
    // function to handle correct guess
    guessButton.disabled = true; // disable further guesses
    document.getElementById('difficulty').disabled = false; // re-enable difficulty selection
    settingsSaveButton.disabled = false; // re-enable settings save button
    document.getElementById('hintButton').disabled = true; // disable hints after correct guess
    showResults(trackOfTheDay, finalResult); // show results overlay
    incrementGuessNum(); // increment guess distribution stats

    const currentDateStr = new Date().toLocaleDateString();
    // Update stats only if not already played today
    if (lastPlayedDate != currentDateStr) {
        // already played today; don't increment streak
        totalCorrect++;
        localStorage.setItem('totalCorrect', totalCorrect);
        if (lastPlayedDate === new Date(Date.now() - 86400000).toLocaleDateString()) {
            // last played was yesterday; increment streak
            streakCount++;
        } else {
            // last played was before yesterday; reset streak
            streakCount = 1;
        }
        // save updated stats to localStorage
        localStorage.setItem('streakCount', streakCount);
        localStorage.setItem('lastPlayedDate', currentDateStr);
        totalGames++;
        localStorage.setItem('totalGames', totalGames);
        localStorage.setItem('playedToday', 'true');
    }
}

function guessIncorrectly(trackOfTheDay, finalResult) {
    // function to handle incorrect guess after all attempts
    guessButton.disabled = true; // disable further guesses
    document.getElementById('difficulty').disabled = false; // re-enable difficulty selection
    settingsSaveButton.disabled = false; // re-enable settings save button
    document.getElementById('hintButton').disabled = true; // disable hints after game over
    showResults(trackOfTheDay, finalResult); // show results overlay
    numXGuesses++; // increment fail stats
    localStorage.setItem('numXGuesses', numXGuesses); // save to localStorage

    // Update stats
    totalGames++;
    localStorage.setItem('totalGames', totalGames);
    streakCount = 0; // reset streak on incorrect guess
    localStorage.setItem('streakCount', streakCount);
    localStorage.setItem('playedToday', 'true');
    const currentDateStr = new Date().toLocaleDateString();
    localStorage.setItem('lastPlayedDate', currentDateStr);

}

function saveSettings() {
    // function to save settings changes
    const difficulty = document.getElementById('difficulty').value;
    localStorage.setItem('difficulty', difficulty);
    playerDifficulty = difficulty;
    if (playerDifficulty === 'hard') {
        // hide hint button for hard mode
        document.getElementById('hintButton').style.display = 'none';
        // set initial playback time for hard mode
        document.getElementById('playbackTime').textContent = `Playback Time: ${playTimeAllowed/1000} second(s)`;
    } else {
        // show hint button for normal mode
        document.getElementById('hintButton').style.display = 'inline-block';
    }
    // update current difficulty display for user
    document.getElementById('currentDifficulty').textContent = `${playerDifficulty}`;
    document.getElementById('settingsOverlay').classList.add('hidden'); // close settings overlay
}

function showResults(trackOfTheDay, finalResult) {
    // function to display results overlay
    resultsOverlay.classList.remove('hidden');
    document.getElementById('resultsButton').classList.remove('hidden'); // show results button to reopen overlay if it gets closed
    document.getElementById('answer').textContent = `Answer: ${trackOfTheDay.Game}: ${trackOfTheDay.Track}`;
    if (playedToday === false) { // only save result if not already played today
        resultString = parseResult(finalResult);
        localStorage.setItem(`${currentDate}_result`, resultString);
        document.getElementById('results').innerHTML = resultString.replace(/\n/g, '<br>'); // display formatted result with HTML line breaks
    } else {
        document.getElementById('results').innerHTML = finalResult.replace(/\n/g, '<br>');
    }
}

function hintButtonPressed() {
    // function to handle hint button press
    let maxGuesses = 2; // max hints for normal mode
    // Update hints remaining display
    document.getElementById('hintsRemaining').textContent = `Hints Left: ${maxGuesses - (hintsUsed + 1)}`;
    settingsSaveButton.disabled = true; // prevent changing settings mid-game
    
    hintsUsed++; // increment hints used

    // Reveal hint based on number of hints used
    if (hintsUsed === 1) { // first hint: reveal game
        document.getElementById('hintReveal').textContent = trackOfTheDay.Game;
    } else {
        if (hintsUsed < maxGuesses) { // second hint: reveal part of track name
            document.getElementById('hintReveal').textContent = `${trackOfTheDay.Game} - ${trackOfTheDay.Track.slice(0, hintsUsed - 1)}`;
        } else { // no more hints: reveal another part of track name and disable hint button
            document.getElementById('hintReveal').textContent = `${trackOfTheDay.Game} - ${trackOfTheDay.Track.slice(0, hintsUsed - 1)}`;
            document.getElementById('hintButton').disabled = true;
        }
    }
}

function createGuessChart() {
    // function to create guess distribution chart using Chart.js
    let labels = ['1','2','3','4','5','6', 'X'];
    let data = {
        labels: labels,
        datasets: [{
            label: 'Number of Guesses',
            backgroundColor: 'rgb(204, 0, 0)',
            borderColor: 'rgb(0, 0, 0)',
            data: [num1Guesses, num2Guesses, num3Guesses, num4Guesses, num5Guesses, num6Guesses, numXGuesses],
        }]
    };

    const config = {
        type: 'bar',
        data: data,
        options: {
            responsive: false,
        }
    };

    var guessChart = new Chart(
        document.getElementById('guessDistribution'),
        config
    );
}

function incrementGuessNum() {
    // function to increment guess distribution stats
    if (guessNum === 1) {
        num1Guesses++;
        localStorage.setItem('num1Guesses', num1Guesses);
    } else if (guessNum === 2) {
        num2Guesses++;
        localStorage.setItem('num2Guesses', num2Guesses);
    } else if (guessNum === 3) {
        num3Guesses++;
        localStorage.setItem('num3Guesses', num3Guesses);
    } else if (guessNum === 4) {
        num4Guesses++;
        localStorage.setItem('num4Guesses', num4Guesses);
    } else if (guessNum === 5) {
        num5Guesses++;
        localStorage.setItem('num5Guesses', num5Guesses);
    } else if (guessNum === 6) {
        num6Guesses++;
        localStorage.setItem('num6Guesses', num6Guesses);
    }
}